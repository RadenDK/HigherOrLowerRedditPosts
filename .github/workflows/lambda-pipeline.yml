name: Deploy Python Script to AWS Lambda

on:
  push:
    paths:
      - 'python-scripts/**'


jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    # CD part
    - name: Deploy to Lambda
      uses: appleboy/lambda-action@v0.1.9
      with:
        aws_access_key_id: ${{ secrets.AWS_LAMBDA_ACCESS_KEY_ID }}
        aws_secret_access_key: ${{ secrets.AWS_LAMBDA_SECRET_ACCESS_KEY }}
        aws_region: ${{ secrets.AWS_REGION }}
        function_name: redditPostsUpdater
        source: python-scripts/reddit-posts-updater/lambda_function.py
